var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r};define(["require","exports","khesht/utils","khesht/dom","khesht/component"],function(n,t,i,r,u){return function(n){function t(t){t===void 0&&(t={});this.args=t;n.call(this,r.body.empty());NProgress.inc()}return __extends(t,n),t.load=function(n){var t=this;if(n===void 0&&(n=i.parsURL()),NProgress.start(),i.isString(n)&&(n={page:n}),n.page=n.page||"index",this.current&&window.history.pushState(n,"",i.url(n)),!this.historyListener){$(window).on("popstate",function(){i.log(history.state);history.state&&history.state.page&&t.load(history.state)});this.historyListener=!0}i.loadModule("pages/"+n.page,function(i){t.current=new i(n)},function(){n.page!="notfound"&&t.load({page:"notfound"})})},t.navigate=function(n){return n.preventDefault(),n.stopPropagation(),t.load(i.parsURL($(n.target).attr("href"))),!1},t.prototype.start=function(){n.prototype.start.call(this);this.header();this.body();this.footer();NProgress.done()},t.prototype.header=function(){},t.prototype.body=function(){},t.prototype.footer=function(){},Object.defineProperty(t.prototype,"url",{get:function(){return i.url(this.args)},enumerable:!0,configurable:!0}),t}(u)})